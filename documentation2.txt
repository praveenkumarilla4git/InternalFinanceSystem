ðŸ“˜ Operations Manual: Internal Finance System
Objective: Deploy a Python Flask application using Docker on AWS EC2. OS Version: Amazon Linux 2023 (Latest) Author: Praveen

Phase 1: Local Development (On Laptop)
Create a folder named InternalFinanceSystem and create the following 5 files inside it.

1. requirements.txt
This tells Python which libraries we need.

Flask

2. core.py (Business Logic)
This handles the math.

Python

def calculate_savings(monthly_amount):
    # Project monthly savings to an annual total
    return monthly_amount * 12
	
	
3. schema.py (Database Setup)
This creates the database file automatically.

Python

import sqlite3

connection = sqlite3.connect("finance.db")
cursor = connection.cursor()

# Create table if it doesn't exist
cursor.execute("""
    CREATE TABLE IF NOT EXISTS users_data (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        user_name TEXT,
        estimated_annual REAL,
        reason_text TEXT,
        db_data TIMESTAMP DEFAULT CURRENT_TIMESTAMP
    )
""")
connection.commit()
connection.close()


4. main.py (The Web Server)
CRITICAL: Note the host="0.0.0.0" at the bottom. This allows the app to be seen from the internet.

Python

from flask import Flask, render_template, request, redirect
import sqlite3
import core
import schema  # Runs the DB setup immediately

app = Flask(__name__)

@app.route("/", methods=["GET", "POST"])
def home():
    estimated_annual = 0
    current_user = "Praveen"
    reason_text = ""
    
    if request.method == "POST":
        monthly_input = float(request.form.get("monthly_amount"))
        reason_text = request.form.get("reason_goal")
        estimated_annual = core.calculate_savings(monthly_input)

        # Save to DB
        connection = sqlite3.connect("finance.db")
        cursor = connection.cursor()
        cursor.execute("INSERT INTO users_data (user_name, estimated_annual, reason_text) VALUES (?, ?, ?)", 
                       (current_user, estimated_annual, reason_text))
        connection.commit()
        connection.close()

    # Read History
    connection = sqlite3.connect("finance.db")
    cursor = connection.cursor()
    cursor.execute("SELECT * FROM users_data")
    db_data = cursor.fetchall()
    connection.close()

    return render_template("index.html", 
                           user_name=current_user, 
                           money=estimated_annual, 
                           reason=reason_text,
                           history=db_data)

if __name__ == "__main__":
    # HOST 0.0.0.0 IS REQUIRED FOR DOCKER/CLOUD ACCESS
    app.run(debug=True, host="0.0.0.0")
	

5. templates/index.html
(Create a folder named templates, then create this file inside it).

HTML

<!DOCTYPE html>
<html>
<head><title>Finance Portal</title></head>
<body style="text-align:center; font-family: sans-serif;">
    <h2>Internal Finance Portal</h2>
    <p>Welcome back, <b>{{ user_name }}</b></p>
    <form method="POST">
        Reason / Goal: <input type="text" name="reason_goal" required> <br><br>
        Monthly Amount: <input type="number" name="monthly_amount" required>
        <button type="submit">Calculate</button>
    </form>
    <hr>
    <h3>Savings Projection History</h3>
    <table border="1" style="margin: 0 auto;">
        <tr>
            <th>ID</th>
            <th>Reason</th>
            <th>Annual Projection</th>
        </tr>
        {% for row in history %}
        <tr>
            <td>{{ row[0] }}</td>
            <td>{{ row[3] }}</td>
            <td>{{ row[2] }}</td>
        </tr>
        {% endfor %}
    </table>
</body>
</html>

6. Dockerfile (The Blueprint)
Create a file named exactly Dockerfile (no extension).

Dockerfile

FROM python:3.10-slim
WORKDIR /app
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt
COPY . .
RUN python schema.py
CMD ["python", "main.py"]



Phase 2: Push to GitHub (On Laptop)
Open Terminal in VS Code.

Run these commands to save and upload:

Bash

git init
git add .
git commit -m "Initial Deployment Code"
# Replace URL below with your actual repository URL
git remote add origin https://github.com/praveenkumarilla4git/InternalFinanceSystem.git
git push -u origin main


Phase 3: Server Setup (On AWS Cloud)
Launch Instance:

OS: Amazon Linux 2023.

Instance Type: t2.micro or t3.micro.

Key Pair: Select your .pem key.

SSH Login:

Bash

ssh -i "your-key.pem" ec2-user@YOUR_PUBLIC_IP


Execution Steps (Copy-Paste Block)
Run these commands one by one on the Black Server Screen.

1. Clean up Pre-installed Tools: (Amazon Linux 2023 comes with "Podman", which conflicts with Docker).

Bash

sudo yum remove -y podman podman-docker
Expected Output: "Complete!"


2. Install Real Docker & Git:

Bash

sudo yum install -y docker git
Expected Output: "Complete!"


3. Start Docker Service:

Bash

sudo service docker start
sudo systemctl enable docker

Expected Output: "Created symlink..."

4. Fix User Permissions: (Allows ec2-user to run Docker without sudo).

Bash

sudo usermod -a -G docker ec2-user
newgrp docker

5. Verification:

Bash

docker --version
Expected Output: Docker version 25.0.x...


Phase 4: Deployment (On AWS Cloud)
1. Download the App:

Bash

git clone https://github.com/praveenkumarilla4git/InternalFinanceSystem.git
cd InternalFinanceSystem

2. Build the Docker Image:

Bash

docker build -t finance-app .

Expected Output: Steps 1/6 to 6/6 complete. "naming to docker.io/library/finance-app".

3. Run the Container:

Bash

docker run -d -p 5000:5000 finance-app

Expected Output: A long string of characters (Container ID).

4. verify it is running:

Bash

docker ps
Expected Output: You should see 0.0.0.0:5000->5000/tcp under PORTS.


Phase 5: Go Live (Security Group)
The app is running, but the firewall is closed.

Go to AWS Console > EC2.

Select your Instance -> Click "Security" Tab.

Click the Security Group ID link.

Click "Edit inbound rules".

Click "Add rule".

Type: Custom TCP

Port range: 5000

Source: 0.0.0.0/0 (Anywhere)

Click "Save rules".

Phase 6: Final Verification
Open your web browser and navigate to: http://YOUR_EC2_PUBLIC_IP:5000

Success Criteria:

You see the "Internal Finance Portal" header.

You can type a number and click "Calculate".

The page reloads and shows your saved data in the table below.










